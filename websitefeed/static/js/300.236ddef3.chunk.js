"use strict";(self.webpackChunkwebsite_editor=self.webpackChunkwebsite_editor||[]).push([[300],{726:(e,t,s)=>{s.d(t,{OE:()=>f,QF:()=>d,Rt:()=>c,Xi:()=>u,ZU:()=>r,hH:()=>m,mi:()=>p,nC:()=>a,oO:()=>i,rs:()=>l,ti:()=>g});const n="taggbox.com",o="https://cloud.tagbox.com",a=`https://api.${n}`,i=`https://app.${n}`,r=`${o}/react-app/media`,c=`https://widget.${n}`,d=`${c}/`,l="6",h=`${a}/website-api/v1`,p=`${o}/website/tagbox/micro-tool-json/content.json`,m=`${h}/theme/get-theme`,u=`${h}/feed/create-feed`,f=`${a}/api/v1/user/signUp`,g="https://ipinfo.io/json?token=f8cbcfd57fe1f1"},313:(e,t,s)=>{s.d(t,{A:()=>r});var n=s(246),o=s(726),a=s(867);const i=e=>{const t=(0,a.yN)("accessToken"),s={guestid:(0,a.yN)("referenceId"),authorization:`Bearer ${t}`};return{...e,headers:{...s,...e.headers}}};const r=class{constructor(){const e={baseURL:o.nC},t=n.A.create(e);return t.interceptors.request.use(i),n.A.interceptors.response.use((function(e){return e}),(function(e){return Promise.reject(e)})),t}}},402:(e,t,s)=>{s.d(t,{A:()=>a});var n=s(726),o=s(414);const a=e=>{const{altTxt:t,clsname:s,path:a,isPrefix:i}=e;return(0,o.jsx)("img",{src:`${i?"":n.ZU}${a}`,alt:t,className:s,...e})}},919:(e,t,s)=>{s.r(t),s.d(t,{default:()=>k});var n=s(950),o=s(300),a=s(867),i=s(271),r=s(726),c=s(313);const d=(e,t,s,n)=>o=>{let d=(0,a.yN)("referenceId");d||(d=`TGB-${Date.now()}-${Math.floor(1e4*Math.random())}`,(0,a.UW)("referenceId",d)),o({type:i.zh,payload:d}),(e=>(new c.A).get(`${r.hH}?networkId=${e}`))(e).then((r=>{if(null!==r&&void 0!==r&&r.data){const{data:c,statusCode:d}=r.data;if(200==d&&Object.keys(c||{}).length>0){const{themes:r,personalization:d,redisData:l,token:h}=c;if((0,a.UW)("accessToken",h),(null===r||void 0===r?void 0:r.length)>0){const n=(0,a.v4)(t,r),c=n.find((e=>e.themeId==s));o({type:i.H$,payload:{selectedTheme:c,networkId:e}});const l={themes:n,Personalization:d};(0,a.UW)(`widgetThemes-${e}`,l),o({type:i.Vp,payload:{...l,token:h}})}if(null!==l&&void 0!==l&&l.postData){const{postData:t}=l;(0,a.UW)(`postCreated-${e}`,t),(0,a.UW)(`feedCreated-${e}`,1),o({type:i.xg,payload:t})}n&&n(!0)}else n&&n(!1)}})).catch((e=>{n&&n(!1)}))};var l=s(402),h=s(414);const p=(0,n.lazy)((()=>s.e(893).then(s.bind(s,893)))),m=(0,n.lazy)((()=>s.e(616).then(s.bind(s,616)))),u=(0,n.lazy)((()=>s.e(184).then(s.bind(s,184)))),f=(0,n.lazy)((()=>s.e(111).then(s.bind(s,111)))),g=(0,n.lazy)((()=>s.e(810).then(s.bind(s,810)))),y={step:0,noFdCrt:0,networkId:0,netName:"",isMobile:!1,mbOpt:!0,request:!1};class b extends n.Component{constructor(e){var t;super(e),t=this,this.getCNT=()=>{const{stCNT:e}=this.props;(new c.A).get(`${r.mi}?v=${Math.floor(Date.now()/1e3)}`).then((t=>{if(null!==t&&void 0!==t&&t.data){const s=t.data;e(s),s.dummyThemes&&this.checkStep(s.dummyThemes)}})).catch((e=>console.error("ex content",e)))},this.getDWidth=()=>{const e=document.querySelector(".website-editor");e&&this.setState({isMobile:e.offsetWidth<768})},this.checkStep=e=>{const{networkId:t}=this.state,{stTH:s,stSelTH:n,stRfId:o,stPost:i}=this.props;let r=0,c=0;const d=(0,a.yN)("referenceId"),l=(0,a.yN)("accessToken"),h=(0,a.yN)(`widgetThemes-${t}`),p=(0,a.yN)(`feedCreated-${t}`),m=(0,a.yN)(`postCreated-${t}`),u=(0,a.yN)(`selectedTheme-${t}`);d&&l&&h&&Object.keys(h).length>0&&h.themes&&h.Personalization&&(r=1,m&&(c=p||0,r=2));let f=[],g={};0==r?f=e&&Object.keys(e).length>0?e[t]:[]:(2==r&&i(m),f=h.themes,g=h.Personalization),o(d),s(f,g,l),f.length>0&&n(u||f[0],t),this.setState({step:r,noFdCrt:c})},this.resetState=()=>{const{networkId:e,netName:t}=this.state;this.setState({...y,networkId:e,netName:t})},this.moveStep=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const{step:s,networkId:n,noFdCrt:o}=t.state,{getThemes:i,themeData:r}=t.props;if(0==s){const{selectedTheme:e,themes:s}=r;t.setState({request:!0}),i(n,s,e.themeId,(e=>{t.setState({request:!1,step:e?1:0})}))}else if(1==s){const s=e?o+1:o;t.setState({step:2,noFdCrt:s},(()=>{(0,a.UW)(`feedCreated-${n}`,s)}))}else t.setState({step:3})},this.setActiveTab=e=>this.setState({step:e});const{id:s,name:n}=(0,a.zD)();this.state={...y,networkId:s,netName:n}}componentDidMount(){this.getCNT(),this.getDWidth(),window.addEventListener("resize",this.getDWidth)}componentWillUnmount(){window.removeEventListener("resize",this.getDWidth)}render(){const{step:e,networkId:t,isMobile:s,mbOpt:o,netName:a,noFdCrt:i}=this.state,{content:r,themeData:c}=this.props;return(0,h.jsxs)("div",{className:"website-editor micro-main",children:[(0,h.jsx)(n.Suspense,{fallback:null,children:(0,h.jsx)(p,{title:`${a} Widget`,step:e,backAction:()=>this.setState({step:2})})}),(0,h.jsxs)("div",{className:"micro-inn",children:[s?(0,h.jsxs)("div",{className:"mi-mobile-gear "+(o?"":"open"),onClick:()=>this.setState({mbOpt:!o}),children:[(0,h.jsx)(l.A,{path:"/micro/gear.svg",altTxt:"gear",clsname:"img-fluid"}),(0,h.jsx)(l.A,{path:"/micro/close.svg",altTxt:"close",clsname:"img-fluid"})]}):null,e>2?(0,h.jsx)(n.Suspense,{fallback:null,children:(0,h.jsx)(g,{selectedTheme:c.selectedTheme,networkId:t,content:r,resetState:this.resetState})}):(0,h.jsxs)(h.Fragment,{children:[s&&o?null:(0,h.jsxs)(h.Fragment,{children:[0==e?null:(0,h.jsx)(n.Suspense,{fallback:null,children:(0,h.jsx)(m,{...this.state,setActiveTab:this.setActiveTab})}),(0,h.jsx)(n.Suspense,{fallback:null,children:(0,h.jsx)(u,{...this.state,moveStep:this.moveStep})})]}),(0,h.jsx)(n.Suspense,{fallback:null,children:(0,h.jsx)(f,{noFdCrt:i})})]})]})]})}}const k=(0,o.Ng)((e=>({themeData:e.themeReducer,content:e.contentReducer.sCNT})),(e=>({stTH:function(t,s){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return e({type:i.Vp,payload:{themes:t,Personalization:s,token:n}})},stSelTH:(t,s)=>e({type:i.H$,payload:{selectedTheme:t,networkId:s}}),stPost:t=>e({type:i.xg,payload:t}),stRfId:t=>e({type:i.zh,payload:t}),stCNT:t=>e({type:i.gZ,payload:t}),getThemes:(t,s,n,o)=>e(d(t,s,n,o))})))((0,n.memo)(b))}}]);